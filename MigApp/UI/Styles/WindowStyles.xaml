<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:windows="clr-namespace:System.Windows.Shell;assembly=PresentationFramework"
                    xmlns:controls="clr-namespace:MigApp.UI.Controls"
                    xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes">

    <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
    <!--                         WINDOW TITLES                           -->
    <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->

    <Style x:Key="WindowTitleText" TargetType="TextBlock" BasedOn="{StaticResource TextBlockBase}">
        <Setter Property="FontSize" Value="{DynamicResource FontSizeLarge}"/>
        <Setter Property="Foreground" Value="{DynamicResource ForegroundInactiveBrush}"/>
        <Setter Property="FontWeight" Value="{DynamicResource FontWeightSemiBold}"/>
    </Style>

    <Style x:Key="WindowSubtitleText" TargetType="TextBlock" BasedOn="{StaticResource TextBlockBase}">
        <Setter Property="FontSize" Value="{DynamicResource FontSizeNormal}"/>
        <Setter Property="Foreground" Value="{DynamicResource ForegroundInactiveBrush}"/>
        <Setter Property="FontWeight" Value="{DynamicResource FontWeightSemiBold}"/>
    </Style>

    <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
    <!--                       WINDOW BUTTONS                            -->
    <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->

    <Style x:Key="WindowButtonBase" TargetType="Button" BasedOn="{StaticResource MaterialDesignFlatButton}">
        <Setter Property="Width" Value="35" />
        <Setter Property="Height" Value="35" />
        <Setter Property="Background" Value="{DynamicResource TransparentBrush}" />
        <Setter Property="Foreground" Value="{DynamicResource ForegroundBrush}" />
        <Setter Property="BorderThickness" Value="{DynamicResource ThicknessSmall}" />
        <Setter Property="Cursor" Value="Hand" />
        <Setter Property="FontSize" Value="{DynamicResource FontSizeSmall}"/>
        <Setter Property="Padding" Value="0"/>
    </Style>

    <Style x:Key="WindowMinimizeButtonStyle" TargetType="Button" BasedOn="{StaticResource WindowButtonBase}">
        <Setter Property="Content">
            <Setter.Value>
                <materialDesign:PackIcon Kind="Minimize" Margin="-5"/>
            </Setter.Value>
        </Setter>
    </Style>

    <Style x:Key="WindowMaximizeButtonStyle" TargetType="Button" BasedOn="{StaticResource WindowButtonBase}">
        <Setter Property="Content">
            <Setter.Value>
                <materialDesign:PackIcon Kind="Maximize" Margin="-5"/>
            </Setter.Value>
        </Setter>
        <Style.Triggers>
            <DataTrigger Binding="{Binding RelativeSource={RelativeSource AncestorType=Window}, Path=WindowState}" 
             Value="Maximized">
                <Setter Property="Content">
                    <Setter.Value>
                        <materialDesign:PackIcon Kind="DockWindow" Margin="-5" RenderTransformOrigin="0.5,0.5">
                            <materialDesign:PackIcon.RenderTransform>
                                <RotateTransform Angle="180"/>
                            </materialDesign:PackIcon.RenderTransform>
                        </materialDesign:PackIcon>
                    </Setter.Value>
                </Setter>
            </DataTrigger>
        </Style.Triggers>
    </Style>

    <Style x:Key="WindowCloseButtonStyle" TargetType="Button" BasedOn="{StaticResource WindowButtonBase}">
        <Setter Property="Content">
            <Setter.Value>
                <materialDesign:PackIcon Kind="Close" Margin="-5"/>
            </Setter.Value>
        </Setter>
    </Style>

    <Style x:Key="WindowInfoButtonStyle" TargetType="Button" BasedOn="{StaticResource WindowButtonBase}">
        <Setter Property="Content">
            <Setter.Value>
                <materialDesign:PackIcon Kind="Help" Margin="-5"/>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
    <!--                            WINDOW                               -->
    <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->

    <Style x:Key="WindowBaseStyle" TargetType="Window" BasedOn="{StaticResource MaterialDesignWindow}">
        <Setter Property="WindowStyle" Value="None"/>
        <Setter Property="AllowsTransparency" Value="True"/>
        <Setter Property="Background" Value="Transparent"/>
        <Setter Property="ResizeMode" Value="CanResize"/>
        <Setter Property="WindowChrome.WindowChrome">
            <Setter.Value>
                <WindowChrome CaptionHeight="40"
                              ResizeBorderThickness="4"
                              CornerRadius="{DynamicResource CornerRadiusLarge}"
                              GlassFrameThickness="0"
                              UseAeroCaptionButtons="False"
                              NonClientFrameEdges="None"/>
            </Setter.Value>
        </Setter>

        <Setter Property="Template" Value="{DynamicResource WindowBaseTemplate}"/>

    </Style>

    <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
    <!--                         WINDOW TEMPLATE                         -->
    <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->

    <ControlTemplate x:Key="WindowBaseTemplate" TargetType="Window">

        <Border Background="{DynamicResource TransparentBrush}" 
                CornerRadius="{DynamicResource CornerRadiusLarge}" 
                BorderThickness="{DynamicResource ThicknessEdge}" BorderBrush="{DynamicResource WindowBorderBrush}">
            <Grid>
                <Grid.RowDefinitions>
                    <!-- Заголовок -->
                    <RowDefinition Height="Auto"/>
                    <!-- Контент -->
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <!-- Заголовок окна -->
                <Border Grid.Row="0" Background="{DynamicResource Surface4Brush}" 
                        CornerRadius="{DynamicResource TopCornerRadiusLarge}" 
                        Height="{DynamicResource ControlHeightNormal}">
                    <controls:WindowHeaderControl HasIcon="False" 
                                                  SubTitleText="" 
                                                  TitleStyle="{DynamicResource WindowTitleText}" 
                                                  SubTitleStyle="{DynamicResource WindowSubtitleText}"/>
                </Border>

                <Border Grid.Row="1" CornerRadius="{DynamicResource BottomCornerRadiusLarge}">
                    <!-- Основное содержимое -->
                    <ContentPresenter/>
                </Border>
            </Grid>
        </Border>

        <ControlTemplate.Triggers>
            <Trigger Property="WindowState" Value="Maximized">
                <Setter Property="windows:WindowChrome.WindowChrome">
                    <Setter.Value>
                        <WindowChrome CaptionHeight="40"
                                  ResizeBorderThickness="0"
                                  CornerRadius="0"
                                  GlassFrameThickness="0"/>
                    </Setter.Value>
                </Setter>
            </Trigger>
        </ControlTemplate.Triggers>
    </ControlTemplate>
</ResourceDictionary>